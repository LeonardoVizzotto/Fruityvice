import type { NextPage } from 'next';
import Head from 'next/head';
import Card from '../components/Card';
import Footer from '../components/footer';
import Toolbar from '../components/toolbar';
import { HomeContainer, Main } from '../styles/pages/Home';
import CardGrid from '../components/CardGrid';

export interface Fruit {
  family: string;
  genus: string;
  id: number;
  name: string;
  nutritions: {
    calories: number;
    carbohydrates: number;
    fat: number;
    protein: number;
    sugar: number;
  };
  order: string;
}

interface HomeProps {
  data: Fruit[];
}

const Home: NextPage<HomeProps> = props => {
  return (
    <HomeContainer>
      <Head>
        <title>Fruit Salad</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Toolbar />
      <Main>
        <h1>Letâ€™s make a fruit salad!</h1>
        <span>
          Pick a minimum of 3 fruits and make a delicious fruit salad!
        </span>
        <CardGrid>
          {props.data.map(fruit => (
            <Card key={fruit.id} {...fruit} />
          ))}
        </CardGrid>
      </Main>
      <Footer></Footer>
    </HomeContainer>
  );
};

export async function getServerSideProps() {
  const res = await fetch(`https://www.fruityvice.com/api/fruit/all`);
  const data = await res.json();

  return { props: { data } };
}

export default Home;
